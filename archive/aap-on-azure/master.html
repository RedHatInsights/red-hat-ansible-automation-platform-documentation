<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Red Hat Ansible Automation Platform on Microsoft Azure guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article Role ARG Spec">
<div id="header">
<h1>Red Hat Ansible Automation Platform on Microsoft Azure guide</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Thank you for your interest in Red Hat Ansible Automation Platform. Ansible Automation Platform is a commercial offering that helps teams manage complex multi-tier deployments by adding control, knowledge, and delegation to Ansible-powered environments.</p>
</div>
<div class="paragraph">
<p>This guide helps you to understand the installation and use of Ansible Automation Platform on Microsoft Azure. This document has been updated to include information for the latest release of Ansible Automation Platform on Microsoft Azure.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="making-open-source-more-inclusive">Making open source more inclusive</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat is committed to replacing problematic language in our code, documentation, and web properties.
We are beginning with these four terms: master, slave, blacklist, and whitelist.
Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases.
For more details, see <a href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language">our CTO Chris Wright&#8217;s message</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="intro-to-aap-on-azure">1. Introduction to Ansible Automation Platform on Microsoft Azure</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="con-aap-azure-about_aap-azure-intro">1.1. About Red Hat Ansible Automation Platform on Microsoft Azure</h3>
<div class="paragraph _abstract">
<p>Red Hat Ansible Automation Platform on Microsoft Azure is a managed application that you can deploy from the <a href="https://azure.microsoft.com/en-us/marketplace/">Azure Marketplace</a> portal to a resource group in your Azure tenant.
Ansible Automation Platform on Microsoft Azure provides access to a library of Ansible content collections, and it is integrated with key Azure services, so you can start deploying, configuring, and managing infrastructure and applications quickly.</p>
</div>
<div class="paragraph">
<p>The following Red Hat Automation Platform components are available on Red Hat Ansible Automation Platform on Microsoft Azure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Automation Controller</p>
</li>
<li>
<p>Automation Hub</p>
</li>
<li>
<p>Private Automation Hub</p>
</li>
<li>
<p>Automation Service Catalog</p>
</li>
<li>
<p>Ansible Content Collections, including the Microsoft collection for Azure</p>
</li>
<li>
<p>Automation Execution Environment</p>
</li>
<li>
<p>Ansible content tools, including access to Red Hat Insights for Red Hat Ansible Automation Platform</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Automation mesh is not available on Ansible Automation Platform on Microsoft Azure.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-azure-architecture_aap-azure-intro">1.2. Application Architecture</h3>
<div class="paragraph">
<p>Red Hat Ansible Automation Platform on Microsoft Azure is installed as a managed application.
Red Hat manages both the underlying Azure resources and the software running on it while that infrastructure runs in your Azure tenant.</p>
</div>
<div class="paragraph">
<p>The managed application resource group is completely separate from other resource groups in your tenant.
Red Hat only has access to the managed application resource group, with no visibility into other tenant resources.</p>
</div>
<div class="paragraph">
<p>For information about how this works and how resources and access are isolated from the rest of your Azure resources, refer to <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/managed-applications/overview">Azure managed applications overview</a> in the Microsoft <em>Azure managed applications</em> guide.</p>
</div>
<div class="paragraph">
<p>Ansible Automation Platform on Microsoft Azure uses the following resource groups:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new or existing resource group (RG) in your tenant.
This resource group includes a single resource referring to the Ansible Automation Platform on Microsoft Azure managed application deployment.
Red Hat has access to the managed app to perform support, maintenance, and upgrades, but the resource group is outside of Red Hat&#8217;s management.</p>
</li>
<li>
<p>A multi-tenant managed resource group (MRG) that contains most of the infrastructure needed to operate Ansible Automation Platform on Microsoft Azure.
This multi-tenant resource group is shared between the Red Hat tenant and your tenant. Red Hat has full administrative control and you have read-only access to the resource group.</p>
</li>
<li>
<p>An AKS node pool resource group (NPRG).
Microsoft requires the NPRG for AKS deployments. It contains resources that AKS uses to function.
It is created on deployment, and it is outside of Red Hat&#8217;s management.
Refer to <a href="https://docs.microsoft.com/en-us/azure/aks/faq#why-are-two-resource-groups-created-with-aks">Microsoft&#8217;s AKS documentation</a> for more information about NPRGs.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Do not interact with any resources in the node pool resource group (NPRG) unless explicitly directed to by the Red Hat Ansible Automation Platform on Microsoft Azure SRE team.
Changes to resources in the NPRG cannot be protected by Red Hat and can cause irrecoverable damage to the application.</p>
</div>
<div class="paragraph">
<p>Red Hat cannot restrict your ability to change or delete resources in the NPRG.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you install Ansible Automation Platform on Microsoft Azure, you choose whether the deployment is public or private.
This affects how users can access the Ansible Automation Platform user interfaces.</p>
</div>
<div class="paragraph">
<p>Regardless of whether you choose a public or private deployment, you must configure network peering for outbound communication from Ansible Automation Platform to the private networks that contain resources that you want to automate against.
You can configure network peering from Ansible Automation Platform on Microsoft Azure to your private Azure VNets and to on-premises or multi-cloud networks where transit routing with Azure exists.</p>
</div>
<div class="sect3">
<h4 id="con-aap-public-access_aap-azure-intro">1.2.1. Public deployment</h4>
<div class="paragraph">
<p>Public deployments permit ingress to the Ansible Automation Platform on Microsoft Azure user interfaces over the public internet.
Upon deployment, a domain name is issued to the Ansible Automation Platform on Microsoft Azure instance.
No configuration is required to access Ansible Automation Platform.
Users can navigate to the domain from the public internet and log in to the user interfaces.</p>
</div>
<div class="paragraph">
<p>The following diagram outlines the application resources and architecture that are deployed into the managed application resource group on a public deployment of Ansible Automation Platform on Microsoft Azure into your Azure subscription.
The IP ranges change based on the networking address range you set on deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aap-on-azure-public-deployment.png" alt="aap on azure public deployment">
</div>
</div>
</div>
<div class="sect3">
<h4 id="con-aap-private-access_aap-azure-intro">1.2.2. Private deployment</h4>
<div class="paragraph">
<p>A private deployment of Ansible Automation Platform resides in an isolated Azure VNet with no access from external sources: traffic to and from the public internet and other Azure VNets and subnets is blocked.</p>
</div>
<div class="paragraph">
<p>To access the URLs for the Ansible Automation Platform user interfaces, you must configure network peering.</p>
</div>
<div class="paragraph">
<p>Once peering and routing are configured, users can access Ansible Automation Platform through a VM on a connected Azure subnet, or directly if your organization has transit routing set up between Azure and your local network.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>No two Azure networking configurations are the same.
To allow user access to your Ansible Automation Platform URLs, your organization will need to work with your Azure administrators to connect the private access deployment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following diagram outlines the application resources and architecture that are deployed into the managed application resource group on a private deployment of Ansible Automation Platform on Microsoft Azure into your Azure subscription.
The IP ranges change based on the networking address range you set on deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aap-on-azure-private-deployment.png" alt="aap on azure private deployment">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-azure-network_aap-azure-intro">1.3. Network</h3>
<div class="paragraph">
<p>You can configure the networking address range (CIDR block) for the VNet that your Ansible Automation Platform on Microsoft Azure application uses.
You set the CIDR block for the application in a network configuration form when you deploy Ansible Automation Platform on Microsoft Azure.
Plan your networking configuration before you deploy the Ansible Automation Platform on Microsoft Azure application, because you cannot change it after deployment.</p>
</div>
<div class="paragraph">
<p>When you are planning your network configuration, bear the following in mind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The managed application requires at least a /24 Vnet that is divided into four subnets. The subnets have minimum address spacing.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Networking entity</th>
<th class="tableblock halign-left valign-top">Minimum CIDR Block</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>VNet</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>/24</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Cluster subnet</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>/26</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Gateway subnet</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>/28</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Database subnet</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>/28</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Private link subnet</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>/28</p>
</div></div></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Ensure that the VNet range you configure does not intersect with the default CIDR block for AKS clusters (10.0.0.0/16).
The Azure user interface does not prevent you entering this range, but using the default AKS CIDR block for your VNet causes networking issues.</p>
</li>
<li>
<p>To ensure successful network peering and communication between Ansible Automation Platform on Microsoft Azure and your existing networks, your enterprise network ranges must not overlap with the VNet network range.</p>
</li>
<li>
<p>If you do not have any existing Azure VNets, the Azure user interface suggests a default CIDR block and range for the VNet.
Do not accept these defaults. Instead, use the network configuration that you have planned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about planning the network address range and completing the networking configuration form on deployment, refer to
<a href="https://access.redhat.com/articles/6973251">Red Hat Ansible Automation Platform on Microsoft Azure VNet Preparation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-azure-infrastructure-usage_aap-azure-intro">1.4. Ansible Automation Platform on Microsoft Azure infrastructure usage</h3>
<div class="paragraph">
<p>When you install Ansible Automation Platform on Microsoft Azure, the following infrastructure is deployed into your Azure subscription:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Azure Kubernetes service (AKS)</dt>
<dd>
<p>The Kubernetes cluster used to deploy Ansible Automation Platform applications and services.</p>
<div class="paragraph">
<p><strong>Service Shape:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Compute nodes: Standard_D4s_v3 (4 vCPUs x 16 GiB)</p>
</li>
<li>
<p>Autoscaling minimum nodes: 2</p>
</li>
<li>
<p>Autoscaling maximum nodes: 20</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Managed identity</dt>
<dd>
<p>An Azure service that enables Ansible Automation Platform components to communicate with other Azure services such as database, DNS, storage, and other services.</p>
</dd>
<dt class="hdlist1">Key vault</dt>
<dd>
<p>A secure key vault used to store secrets that are unique to the Ansible Automation Platform deployment.</p>
</dd>
<dt class="hdlist1">Log Analytics Workspace</dt>
<dd>
<p>An Azure service that enables Red Hat site reliability engineers to inspect the operations of Ansible Automation Platform on Microsoft Azure.</p>
</dd>
<dt class="hdlist1">Private DNS Zone</dt>
<dd>
<p>Manages local DNS requests for the services used by Ansible Automation Platform on Microsoft Azure.</p>
</dd>
<dt class="hdlist1">Azure Database for PostgreSQL</dt>
<dd>
<p>An Azure database service used for Ansible Automation Platform’s PostgreSQL database.</p>
<div class="paragraph">
<p><strong>Service Shape:</strong> 1 TB</p>
</div>
</dd>
<dt class="hdlist1">Storage account</dt>
<dd>
<p>The Azure service is used for file and block storage for local storage of projects, containers, etc.</p>
<div class="paragraph">
<p><strong>Service Shape:</strong> StorageV2 - Standard_LRS</p>
</div>
</dd>
<dt class="hdlist1">Virtual network</dt>
<dd>
<p>The Azure service is used to manage all internal networking and dependent services such as the Azure Application Gateway.</p>
<div class="paragraph">
<p><strong>Service Shape:</strong> Application Gateway: WAF_v2</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Exact infrastructure usage depends on the length of time that the managed application is deployed in your tenancy, and the automation requirements that might cause the Kubernetes cluster to autoscale to meet the demands of your workload.</p>
</div>
<div class="paragraph">
<p>Microsoft provides a <a href="https://azure.microsoft.com/en-us/pricing/calculator/">Pricing calculator</a> to estimate your costs for Azure products and services.
Red Hat has configured an example scenario in the pricing calculator: use the <a href="https://azure.com/e/d12a08795a4942c1801c610810791764">Red Hat Ansible Automation Platform on Azure Infrastructure Estimate</a> to tune Kubernetes expected auto scaling variables based on your organization’s workloads.</p>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-azure-lifecycle_aap-azure-intro">1.5. Lifecycle management</h3>
<div class="paragraph">
<p>Red Hat Ansible is responsible for the monitoring, health, and maintenance of the underlying services and Ansible Automation Platform on Microsoft Azure core systems as well as the operation of Ansible Automation Platform on Microsoft Azure itself.
This includes lifecycle management of the components.</p>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-azure-scaling_aap-azure-intro">1.6. Ansible Automation Platform on Microsoft Azure scaling</h3>
<div class="paragraph">
<p>Ansible Automation Platform on Microsoft Azure default configuration of <a href="https://docs.microsoft.com/en-us/azure/aks/cluster-autoscaler#about-the-cluster-autoscaler">Microsoft Azure cluster autoscaler</a> for autoscaling, with the following settings to limit the number of nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Minimum Nodes: 1</p>
</li>
<li>
<p>Maximum Nodes: 20</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-azure-migration_aap-azure-intro">1.7. Migration</h3>
<div class="paragraph">
<p>Red Hat does not provide a solution to migrate existing deployments to Ansible Automation Platform on Microsoft Azure.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aap-azure-install">2. Installing Red Hat Ansible Automation Platform on Microsoft Azure</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites">2.1. Prerequisites</h3>
<div class="ulist">
<div class="title">Azure requirements</div>
<ul>
<li>
<p>A subscription for Microsoft Azure.</p>
</li>
<li>
<p>Contributor or Administrator access to that Azure subscription.</p>
</li>
<li>
<p>Access to the Azure CLI.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Ansible Automation Platform requirements</div>
<ul>
<li>
<p>An account on the Red Hat Red Hat Customer Portal (<a href="https://access.redhat.com/">access.redhat.com</a>).</p>
</li>
<li>
<p>A specific subscription entitlement for Red Hat Ansible Automation Platform.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="proc-azure-resource-quotas_aap-azure-install">2.1.1. Azure resource quotas and infrastructure limits</h4>
<div class="paragraph">
<p>Microsoft imposes resource limits within each Azure region. The CPU limit is the most likely to impact Red Hat Ansible Automation Platform on Microsoft Azure.</p>
</div>
<div class="paragraph">
<p>Before you install Ansible Automation Platform on Microsoft Azure, ensure that you have capacity to deploy the managed application into your desired region.
Refer to <a href="#con-aap-azure-infrastructure-usage_aap-azure-intro">Azure infrastructure usage</a> for infrastructure requirements.</p>
</div>
<div class="sect4">
<h5 id="_regional_vcpu_limits">Regional vCPU limits</h5>
<div class="paragraph">
<p>The Azure resources used during the deployment of the managed application temporarily exceed the resource requirements in <a href="#con-aap-azure-infrastructure-usage_aap-azure-intro">Azure infrastructure usage</a>.
The <code>Total Regional vCPUs</code> quota is temporarily consumed when deploying the managed application.</p>
</div>
<div class="paragraph">
<p>Every Azure region has a separate <code>Total Regional vCPUs</code> quota.
To prevent installation failure, ensure that you have at least 80 DS2_V3 vCPUs available in the Azure region where you want to deploy the managed application.</p>
</div>
<div class="paragraph">
<p>The following steps describe how to view the resource quotas for your subscription the Azure console:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Azure console, search for <strong>Quotas</strong> and open the <strong>My Quotas</strong> page.</p>
</li>
<li>
<p>Select the region where you wish to deploy the managed application to view your allocation and usage metrics for that region.
Ensure that you have selected a single region. Viewing all regions at once will not show the limitations of a single Azure region.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_regional_standardcore_limits">Regional StandardCore limits</h5>
<div class="paragraph">
<p>The <code>StandardCore</code> limit is a compute metric for the resources that are temporarily consumed when deploying the managed application.</p>
</div>
<div class="paragraph">
<p>It is possible that the Ansible Automation Platform on Microsoft Azure can deploy without hitting the <code>StandardCore</code> limit.
When a deployment fails because the consumed resources hit the <code>StandardCore</code> limit, the error message includes <code>container group quota 'StandardCores' exceeded</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>code: DeploymentFailed
message:
  At least one resource deployment operation failed. Please list deployment operations for details.
  Please see https://aka.ms/DeployOperations for usage details.
details:
  - code: DeploymentScriptContainerGroupInvalidSettings
    message:
      Resource type 'Microsoft.ContainerInstance/containerGroups'
      container group quota 'StandardCores' exceeded in region 'eastus'.
      Limit: '10', Usage: '10' Requested: '1'.</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Requesting StandardCore limit increase</div>
<p>The <code>StandardCore</code> metric is not displayed in the <strong>My Quotas</strong> page in the Azure console. To request the value of your regional limit, contact Microsoft directly.</p>
</div>
<div class="paragraph">
<p>If your deployments fail because the consumed resources reach this limit, you must submit a resource increase request for <code>StandardCore</code> to Microsoft.
Only submit a quota increase request if you encounter a deployment failure due to this issue.</p>
</div>
<div class="paragraph">
<p>Use the following information to respond to questions from Microsoft support:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Will the container groups be run in Linux or Windows?</dt>
<dd>
<p>Linux</p>
</dd>
<dt class="hdlist1">What will the core and memory be in your Container Group instance?</dt>
<dd>
<p>Red Hat recommends 20 cores, 16 GB</p>
</dd>
<dt class="hdlist1">When will you create all the Container Group Instances?</dt>
<dd>
<p>During managed application deployment of Red Hat Ansible Automation Platform on Microsoft Azure</p>
</dd>
<dt class="hdlist1">How frequent will you create/delete the container groups?</dt>
<dd>
<p>Only during managed application deployment of Red Hat Ansible Automation Platform on Microsoft Azure</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-azure-create-service-principal_aap-azure-install">2.2. Creating a service principal</h3>
<div class="paragraph _abstract">
<p>To enable the Ansible Automation Platform application to access and manage Azure resources, you must provide authorization credentials after deployment.
The Microsoft Azure collection supports service principal authentication.</p>
</div>
<div class="paragraph">
<p>To create a service principal, you must have administrator privileges with tenancy-wide permissions on your Azure tenant.
Your Ansible Automation Platform on Microsoft Azure deployment will be provisioned in the same Subscription ID as the service principal created in this step.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the Azure portal and click the <a href="https://docs.microsoft.com/en-us/azure/cloud-shell/overview">Cloud Shell</a> icon to open a bash Cloud Shell in your browser.</p>
</li>
<li>
<p>Set the Azure CLI to use the subscription that you intend to use for automating Azure services. Run the following command from the shell:</p>
<div class="listingblock">
<div class="content">
<pre>az account set --subscription &lt;your_subscription_id&gt;</pre>
</div>
</div>
</li>
<li>
<p>Run the following command using the Azure CLI to create a privileged service principal in Azure AD:</p>
<div class="listingblock">
<div class="content">
<pre>az ad sp create-for-rbac --name ansible --role Contributor</pre>
</div>
</div>
<div class="paragraph">
<p>The output displays the <em>appID</em> and <em>tenant</em> keys for the service principal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "appId": "xxxxxxx-xxx-xxxx",
  "displayName": "ansible",
  "name": "xxxxxxx-xxx-xxxx",
  "password": "xxxxxxx-xxx-xxxx",
  "tenant": "xxxxxxx-xxx-xxxx"
}</pre>
</div>
</div>
</li>
<li>
<p>Store the service principal details securely, as they are displayed only when you create the secret. You will need them when you deploy Automation controller.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_maintaining_your_service_principals">2.2.1. Maintaining your service principals</h4>
<div class="paragraph">
<p>Service principal credentials have a limited lifetime that is set in your Azure AD configuration.
Track the lifespan of the service principal if you intend to automate against Azure for an extended period of time.
You can create a new one when needed.</p>
</div>
<div class="paragraph">
<p>To view records of updated or deleted service principles, run the following Azure CLI command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>az ad sp list -o table | grep ansible</pre>
</div>
</div>
<div class="paragraph">
<p>This command does not display the secrets for your service principals. Delete the service principal and create a new one if the secret is lost.</p>
</div>
<div class="paragraph">
<p>When you create a new service principal to replace an expired or deleted one, you must update the credential that uses the service principal that you are replacing. If the credential is not updated, automations that use that credential will fail.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-azure-proc-azure-deploy-aap_aap-azure-install">2.3. Deploying Ansible Automation Platform from Azure Marketplace</h3>
<div class="sect3">
<h4 id="proc-azure-locate-aap-marketplace_aap-azure-install">2.3.1. Locating Ansible Automation Platform in Azure Marketplace</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a browser, navigate to the Azure Marketplace.</p>
</li>
<li>
<p>Click <strong>Private Products</strong> from the menu on the left of the screen.</p>
</li>
<li>
<p>Search for Red Hat Ansible Automation Platform.</p>
</li>
<li>
<p>Click the card that is returned in the search. Be sure to select the official offering from Red Hat.</p>
</li>
<li>
<p>Click <strong>Get it Now</strong>, <strong>Continue</strong>, and then <strong>Create</strong> to initiate the deployment process.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="proc-azure-provisioning-aap_aap-azure-install">2.3.2. Provisioning Red Hat Ansible Automation Platform on Microsoft Azure</h4>
<div class="paragraph _abstract">
<p>When you initiate the deployment of the Red Hat Ansible Automation Platform managed app from Azure marketplace, a form is displayed in the <strong>Create Red Hat Ansible Automation Platform on Microsoft Azure</strong> window.</p>
</div>
<div class="paragraph">
<p>Before you fill in the form, decide whether you want to create a public or private deployment of Ansible Automation Platform on Microsoft Azure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Public deployments allow ingress to the Ansible Automation Platform on Microsoft Azure user interfaces over the public internet. No configuration is required to access the application URLs.</p>
</li>
<li>
<p>Private deployments are created in an isolated Azure VNet that blocks access from the public internet. To access Ansible Automation Platform on Microsoft Azure user interfaces, you must configure network peering and routing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You create the network configuration for the Ansible Automation Platform on Microsoft Azure VNet when you initiate the deployment.
Refer to your network configuration plan before deploying the managed application. For information about planning your network configuration, see <a href="#con-aap-azure-network_aap-azure-intro">Networking configuration</a>.</p>
</div>
<div class="paragraph">
<p>Complete the form to provision Red Hat Ansible Automation Platform infrastructure and resources into your Azure tenant.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enter values for your deployment in the following fields in the form:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Subscription</strong>: Select <strong>Ansible on Clouds</strong>.</p>
</li>
<li>
<p><strong>Resource Group</strong>: Create or select a resource group where you want to deploy the managed application.</p>
</li>
<li>
<p><strong>Region</strong>: The Azure region where the application will be deployed.</p>
</li>
<li>
<p><strong>Application Name</strong>: A unique name for the managed application.</p>
</li>
<li>
<p><strong>Administrator Password</strong>: Create an adminstrator password for your deployment.</p>
<div class="paragraph">
<p>The <em>Administrator Password</em> must contain at least 8 characters, and must include uppercase letters, lowercase letters, and numbers.</p>
</div>
</li>
<li>
<p><strong>Confirm Administrator Password</strong>: Confirm the <em>Administrator Password</em>.</p>
</li>
<li>
<p><strong>Access</strong>: Choose whether your deployment will be public or private.</p>
</li>
<li>
<p><strong>Managed Resource Group</strong>: A resource group for the managed application infrastructure.</p>
<div class="paragraph">
<p>Keep this resource group isolated from other resource groups, including the <em>Resource Group</em> where you will deploy the managed application.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Store the information that you entered in the form in a secure place. You will need to provide the <em>Administrator password</em> to access automation controller and private automation hub.</p>
</li>
<li>
<p>Click <b class="button">Next</b></p>
</li>
<li>
<p>Follow the steps in <a href="https://access.redhat.com/articles/6973251">Red Hat Ansible Automation Platform on Microsoft Azure VNet Preparation</a> to configure your network configuration.</p>
</li>
<li>
<p>Click <b class="button">Review + Create</b>.</p>
</li>
<li>
<p>If the information you entered in the form is valid, the window displays <strong>Validation Passed</strong>.</p>
</li>
<li>
<p>Select <strong>I agree</strong> to accept the Co-Admin Access Permissions terms and conditions.</p>
</li>
<li>
<p>Click <b class="button">Create</b> to begin the provisioning process for the application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The application will begin provisioning.</p>
</div>
<div class="paragraph">
<p>It may take 30 minutes or longer for the infrastructure and software to fully provision.</p>
</div>
<div class="paragraph">
<p>Once provisioning is complete, you can access and login to your new Ansible Automation Platform instance and launch automation controller and automation hub.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-azure-accessing-aap_aap-azure-install">2.4. Accessing Red Hat Ansible Automation Platform on Microsoft Azure</h3>
<div class="paragraph _abstract">
<p>When you initiate the deployment of the Red Hat Ansible Automation Platform managed app from Azure marketplace, a form is displayed in the <strong>Create Red Hat Ansible Automation Platform on Microsoft Azure</strong> window.
Complete the form to provision Ansible Automation Platform infrastructure and resources into your Azure tenant.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a web browser, navigate to <strong>Managed Applications</strong> in the Azure console.</p>
</li>
<li>
<p>Select the instance of Red Hat Ansible Automation Platform on Microsoft Azure that you deployed.</p>
</li>
<li>
<p>Select <strong>Parameters and Outputs</strong> in the <strong>Settings</strong> section in the left navigation menu.</p>
</li>
<li>
<p>Copy the URL links for automation controller and automation hub, and then save them. The names for the links are <em>automationControllerUrl</em> and <em>automationHubUrl</em>.</p>
</li>
<li>
<p>In a browser, navigate to the automation controller URL, and then log in using the following credentials:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Username</strong>: <code>admin</code></p>
</li>
<li>
<p><strong>Password</strong>: Use the <em>Administrator password</em> you provided when you deployed the Ansible Automation Platform application.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first time you login to Ansible Automation Platform on Microsoft Azure, you must configure a subscription and agree to the terms and conditions.</p>
</div>
<div class="sect3">
<h4 id="proc-azure-license-association_aap-azure-install">2.4.1. License association</h4>
<div class="paragraph">
<p>Red Hat provided a specific subscription entitlement manifest when you subscribed to Red Hat Ansible Automation Platform on Microsoft Azure.</p>
</div>
<div class="paragraph">
<p>When asked to submit information about your license, select your license manifest file that you obtained from access.redhat.com.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc-azure-configure-ad-sso_aap-azure-install">2.4.2. Azure Active Directory (Azure AD) SSO configuration</h4>
<div class="paragraph _abstract">
<p>Follow the procedures below to configure SSO with Azure Active Directory (Azure AD). If your organization does not use Azure AD for application authorization, you can create users in the user management system in Ansible Automation Platform.</p>
</div>
<div class="olist arabic">
<div class="title">Configuring the base URL for the Ansible Automation Platform deployment</div>
<ol class="arabic">
<li>
<p>In a browser, navigate to the Automation controller URL and log in using the following credentials:</p>
<div class="ulist">
<ul>
<li>
<p>Username: <code>admin</code></p>
</li>
<li>
<p>Password: Use the <em>Administrator password</em> you provided when you deployed the Ansible Automation Platform application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the Automation controller console, click <strong>Settings</strong> in the menu options.</p>
</li>
<li>
<p>Click <strong>Miscellaneous System settings</strong> under the <strong>System</strong> settings.</p>
</li>
<li>
<p>Click <strong>Edit</strong>. Enter the Automation controller URL in the Base URl of the service field.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Configuring authentication for Ansible Automation Platform</div>
<p>To set up enterprise authentication for Microsoft Azure Active Directory (Azure AD), you must obtain an OAuth2 key and secret by registering your Ansible Automation Platform deployment in Azure.</p>
</div>
<div class="paragraph">
<p>To register the automation controller instance in Azure, you must supply the <em>Azure AD OAuth2 Callback URL</em> from the automation controller settings.</p>
</div>
<div class="olist arabic">
<div class="title">Fetching the Azure AD OAuth2 Callback URL</div>
<ol class="arabic">
<li>
<p>In a web browser, open the automation controller console.</p>
</li>
<li>
<p>Click <strong>Settings</strong> in the menu to open the main settings page.</p>
</li>
<li>
<p>Click <strong>Azure AD settings</strong> in the <strong>Authentication</strong> category to open the <strong>Details</strong> page.</p>
</li>
<li>
<p>Copy the value for <em>Azure AD OAuth2 Callback URL</em>. You will need this value when you register your deployed application in Azure AD.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Creating a registered application in Azure AD</div>
<ol class="arabic">
<li>
<p>In a web browser, open the Azure portal.</p>
</li>
<li>
<p>Ensure that you are using the tenant where you deployed Ansible Automation Platform.</p>
</li>
<li>
<p>Type <code>Azure Active Directory</code> in the search bar.</p>
</li>
<li>
<p>Select <strong>Azure Active Directory</strong> from the search results.</p>
</li>
<li>
<p>Under <strong>Manage</strong> in the menu options, click <strong>App registrations</strong>.</p>
</li>
<li>
<p>In the <strong>App registrations</strong> page, click <strong>+ New registration</strong>.</p>
</li>
<li>
<p>Configure the new registration as follows:</p>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Name</strong> field, enter the same name that you used for the deployed application.</p>
</li>
<li>
<p>Select the default value for <strong>Supported account types</strong>.</p>
</li>
<li>
<p>Select <strong>Web</strong> for <strong>Redirect URI (optional)</strong>.</p>
</li>
<li>
<p>In the <strong>Redirect URI (optional)</strong> field, enter the <em>Azure AD OAuth2 Callback URL</em> value that you fetched from automation controller.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Register</strong> to create the registration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When registration is complete, the registration page for the Automation Controller application is displayed.</p>
</div>
<div class="olist arabic">
<div class="title">Generating secrets for communication</div>
<ol class="arabic">
<li>
<p>In the <strong>Automation controller application registration page</strong> on Azure, copy and save the value of <em>Application (client) ID</em>.</p>
<div class="paragraph">
<p>You will use this value for the <em>Azure AD OAuth2 Key</em> in the Ansible Automation Platform settings.</p>
</div>
</li>
<li>
<p>Under <strong>Manage</strong>, click <strong>Certificates &amp; secrets</strong>.</p>
</li>
<li>
<p>Click <strong>Client secrets</strong> and then <strong>+ New client secret</strong>.</p>
</li>
<li>
<p>Provide a description for the new secret.</p>
<div class="paragraph">
<p>It is not possible to automatically renew a certificate or identify when it is about to expire.</p>
</div>
<div class="paragraph">
<p>It is useful to include the date in the description, for example: <em>AAP Client Secret &lt;Today&#8217;s Date in YYYY-MM-DD format&gt;</em>.</p>
</div>
</li>
<li>
<p>Provide an expiration date for the new secret.</p>
<div class="paragraph">
<p>The maximum lifetime for the certificate is 2 years. Unless you have specific security needs that prevent the creation of a long term certificate, select an expiration date of <strong>24 months</strong>.</p>
</div>
</li>
<li>
<p>Save the secret <em>Value</em> to a location on your local machine. Once you navigate away from this page it will be hidden and no longer retrievable.</p>
</li>
</ol>
</div>
<div class="paragraph _abstract">
<div class="title">Adding secrets to Ansible Automation Platform settings</div>
<p>Add the key <em>(Application (client) ID)</em> and value (<em>Value</em>) of the secret that you generated in Azure to your Ansible Automation Platform instance.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the automation controller console in a web browser.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Settings</b>&#160;<b class="caret">&#8250;</b> <b class="menuitem">Azure AD settings</b></span>.</p>
</li>
<li>
<p>Click <strong>Edit</strong>.</p>
</li>
<li>
<p>Enter the information for the secret that you generated in Azure AD:</p>
</li>
<li>
<p>In <strong>Azure AD OAuth2 Key</strong>, paste the <em>Application (client) ID</em>.</p>
</li>
<li>
<p>In <strong>Azure AD OAuth2 Secret</strong>, paste the secret <em>Value</em>.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Adding Azure Credentials to Automation controller</div>
<ol class="arabic">
<li>
<p>Open the automation controller in a web browser.</p>
</li>
<li>
<p>Under <strong>Resources</strong>, click <strong>Credentials</strong>.</p>
</li>
<li>
<p>Click <strong>Add</strong> to open the <strong>Create New Credentials</strong> page.</p>
</li>
<li>
<p>Enter a name for the new credential and select <strong>Azure Resource Manager</strong> for the credential type.</p>
</li>
<li>
<p>Use the Service Principal details to fill out the values of the form:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: Choose a descriptive name for the credential, for example <em>*Azure Infrastructure*</em>.</p>
</li>
<li>
<p><strong>Subscription ID</strong>: Enter the subscription id where your resources created in Azure should be associated. This is unique to your tenant. Your organization may have multiple subscription ids; consult your Azure administrator regarding the subscription id that you should use.</p>
</li>
<li>
<p><strong>Client ID</strong>: Enter the appId value from the Service Principal creation.</p>
</li>
<li>
<p><strong>Client Secret</strong>: Enter the password from the Service Principal creation.</p>
</li>
<li>
<p><strong>Tenant ID</strong>: Enter the tenant from the Service Principal creation.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Save</strong> to save the credential.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aap-azure-network-peering">3. Private network peering</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ansible Automation Platform on Microsoft Azure is deployed into an independent managed resource group with its own Azure virtual network (VNet).</p>
</div>
<div class="paragraph">
<p>When initially deployed, Ansible Automation Platform on Microsoft Azure’s VNet can only send requests to external networks through the public internet.</p>
</div>
<div class="paragraph">
<p>To enable Ansible Automation Platform on Microsoft Azure to access resources in an internet-gapped deployment, when access to resources has to happen over private networks, you must configure Azure network peering between your private virtual networks and Red Hat Ansible Automation Platform on Microsoft Azure’s managed application VNet.</p>
</div>
<div class="paragraph">
<p>You can configure your Azure VNets to enable private communication between multiple Azure VNets as well as private transit routing between Azure VNets and external VPN routed networks. These VPN networks can be on-premises or on other clouds.</p>
</div>
<div class="paragraph">
<p>No two Azure networking configurations are the same. To enable user access to Ansible Automation Platform on Microsoft Azure, work with your Azure administrators to connect your deployment to your VNets and external VPN routed networks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Network peering must be configured by Azure administrators in your organizaion who are familiar with Azure networking.
Configuring network changes to your Azure account can cause outages or other disruptions.</p>
</div>
<div class="paragraph">
<p>The network peering procedures described in this document are not supported by Red Hat, as the processes and services are controlled and managed by Microsoft Azure.
Contact Microsoft for assistance in peering Azure networks.</p>
</div>
<div class="paragraph">
<p>While every effort has been made to align with Microsoft’s documentation for this content, there may be drift in accuracy over time.
<a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview">Microsoft’s documentation</a> is the definitive source for information about networking topics for Azure.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Azure offers different ways to peer private networks. These are typically divided into two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Hub-and-spoke peering</strong>: In this topology, there is a centralized hub VNet that other virtual networks peer with.
This hub network has mechanisms to route traffic through transit routing. Cloud networks, including VPN/Express Connect connections with on-premises and other cloud networks, can communicate through the hub VNet.</p>
</li>
<li>
<p><strong>Azure Virtual WAN (VWAN)</strong>: Azure Virtual WAN is a networking service that provides simplified hub-and-spoke network modeling across Azure, on-premises, and other VPN/Direct Connect networks. For more about VWAN, refer to Microsoft&#8217;s <a href="https://docs.microsoft.com/en-us/azure/virtual-wan/virtual-wan-about">Virtual WAN documentation</a>.</p>
</li>
<li>
<p><strong>Direct peering</strong>: Private networks are individually connected to one another with no routing hops between them. This is a simpler peering model: it is useful when you only want to connect a few networks.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Refer to <a href="https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/vnet-peering">Choose between virtual network peering and VPN gateways</a> in the Microsoft <em>Application architecture fundamentals guide</em> to determine the correct peering approach for your organization.</p>
</div>
<div class="sect2">
<h3 id="aap-azure-hub-spoke-peering">3.1. Hub-and-spoke peering (Transit routes)</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Updating route tables incorrectly can break your network. Only execute the steps in these procedures if you are confident that you can reverse any unexpected network behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="proc-azure-hub-spoke-peering_aap-azure-hub-spoke-peering">3.1.1. Hub-and-spoke peering process overview</h4>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have deployed Ansible Automation Platform on Microsoft Azure.</p>
</li>
<li>
<p>You have configured and tested an Azure VNet hub-and-spoke implementation in your Azure tenant. This prerequisite requires many Azure resources to be configured, including a Virtual Network Gateway.</p>
</li>
<li>
<p>You have configured transit routing between your spoke networks, including your VPNs. Refer to <a href="https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-peering-gateway-transit">Configure VPN gateway transit for virtual network peering</a> in the Microsoft Azure documentation for instructions.</p>
</li>
<li>
<p>You have identified the following:</p>
<div class="ulist">
<ul>
<li>
<p>The CIDR block(s) of your existing VNets (including VPNs &amp; direct connects) that will need access to Ansible Automation Platform on Microsoft Azure UIs.</p>
</li>
<li>
<p>The CIDR block(s) of your existing VNets (including VPNs &amp; direct connects) that will contain hosts or endpoints for Ansible automation.</p>
</li>
<li>
<p>The CIDR blocks of the Ansible Automation Platform on Microsoft Azure VNet from the managed resource group of the application. Refer to <a href="#proc-azure-find-cluster-cidr_aap-azure-hub-spoke-peering">Finding the CIDR Block of the managed resource group</a> for instructions.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before peering any networks, ensure that there is no network address space overlap between your private VNets and your Ansible Automation Platform on Microsoft Azure network.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Find the CIDR Block for the Ansible Automation Platform on Microsoft Azure managed application Kubernetes cluster. See <a href="#proc-azure-find-cluster-cidr_aap-azure-hub-spoke-peering">Finding the CIDR Block of the managed application Kubernetes cluster</a>.</p>
</li>
<li>
<p>Configure Network Peering with the Ansible Automation Platform Subnet. See <a href="#proc-azure-nw-peering-aap-subnet_aap-azure-hub-spoke-peering">Configuring Network Peering with the Ansible Automation Platform Subnet</a>.</p>
</li>
<li>
<p>Update the route tables:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configure route tables from your existing networks to send traffic to the managed application CIDR. You must add routes to the routing tables of every network requesting Ansible Automation Platform user interfaces and of every network that will have automation performed against its resources.
See <a href="#routing-to-aap">Routing to Ansible Automation Platform on Microsoft Azure</a>.</p>
</li>
<li>
<p>Configure routing to your VNets for each spoke network that you would like Ansible Automation Platform to communicate with, for automation or for accessing the user interfaces.
See <a href="#routing-to-private-nw">Routing to your VNets</a>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="proc-azure-find-cluster-cidr_aap-azure-hub-spoke-peering">Finding the CIDR Block of the managed resource group</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to the <strong>Resource Groups</strong> page in the Azure portal.</p>
</li>
<li>
<p>Click the managed resource group for Red Hat Ansible Automation Platform on Microsoft Azure. The resource group name is prefixed with “-mrg”.</p>
</li>
<li>
<p>Select the VNet within the resource group to view its settings in the <strong>Overview</strong> page.</p>
<div class="paragraph">
<p>The CIDR block of the cluster is displayed in the <strong>Address Space</strong>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For further information, refer to <a href="https://docs.microsoft.com/en-us/azure/virtual-network/manage-virtual-network#view-virtual-networks-and-settings">View virtual networks and settings</a> in the Microsoft Azure <em>Virtual network</em> guide.</p>
</div>
</div>
<div class="sect4">
<h5 id="proc-azure-nw-peering-aap-subnet_aap-azure-hub-spoke-peering">Configuring network peering with the Ansible Automation Platform subnet</h5>
<div class="paragraph">
<p>Within the Azure console, the Azure virtual network (VNet) is known as <em>this virtual network</em>, and the VNet that you want to peer with is known as <em>remote virtual network</em>.</p>
</div>
<div class="paragraph">
<p>In the <strong>Virtual Networks</strong> page in the Azure portal, use the following settings to configure peering between the Azure VNet and the VNet that you want to peer with the Ansible Automation Platform on Microsoft Azure app:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Under <strong>This virtual network</strong>, select settings for the Ansible Automation Platform on Microsoft Azure virtual network:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Peering link name</strong>: <em>&lt;hub_to_aap_peering_link_name&gt;</em></p>
</li>
<li>
<p><strong>Traffic to remote virtual network</strong>: <em>Allow</em></p>
</li>
<li>
<p><strong>Traffic forwarded from remove virtual network</strong>: <em>Allow</em></p>
</li>
<li>
<p><strong>Virtual network gateway or Route Server</strong>: <em>Use this network’s gateway or Route server</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Under <strong>Remote virtual network</strong>, select settings for the virtual network that you want to peer with Azure:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Peering link name</strong>: <em>&lt;aap_to_hub_peering_link_name&gt;</em></p>
</li>
<li>
<p><strong>Traffic to remote virtual network</strong>: <em>Allow</em></p>
</li>
<li>
<p><strong>Traffic forwarded from remote virtual network</strong>: <em>Allow</em></p>
</li>
<li>
<p><strong>Virtual network gateway or Route Server</strong>: <em>Use the remote virtual network’s gateway or Route server</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For further information on configuring peering, refer to <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-manage-peering#create-a-peering">Create a peering</a> in the Microsoft Azure <em>Virtual network</em> guide.</p>
</div>
</div>
<div class="sect4">
<h5 id="proc-azure-update-route-tables_aap-azure-hub-spoke-peering">Updating the route tables</h5>
<div class="paragraph">
<p>Before you update the route tables, confirm that you satisfy the <a href="#proc-azure-hub-spoke-peering_aap-azure-hub-spoke-peering">prerequisites</a> for the hub-and-spoke peering process.</p>
</div>
<div id="routing-to-aap" class="olist arabic">
<div class="title">Routing to Ansible Automation Platform on Microsoft Azure</div>
<ol class="arabic">
<li>
<p>Navigate to <strong>Route Tables</strong> in the Azure portal.</p>
</li>
<li>
<p>As part of your hub-and-spoke configuration, you created one or more route tables to define the routes between the networks. Click on one of these route tables.</p>
</li>
<li>
<p>From the route table menu bar, click <strong>Routes</strong> &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Configure routes from your existing networks to send traffic to Ansible Automation Platform. You must configure routes for any network requesting Ansible Automation Platform user interfaces and for any network that will have automation performed against its resources.
For each route that you add, enter the following information:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Route name</strong>: Enter a route name for the Ansible Automation Platform managed application network</p>
</li>
<li>
<p><strong>Address Prefix</strong>: The CIDR block of the managed application kubernetes cluster</p>
</li>
<li>
<p><strong>Next Hop Type</strong>: <em>Virtual network gateway</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the new route to the route list.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Repeat this procedure for all other route tables where you want to route traffic to Ansible Automation Platform.</p>
</div>
<div id="routing-to-private-nw" class="paragraph">
<div class="title">Routing to your VNets</div>
<p>Add a route for each spoke network that you would like Ansible Automation Platform to communicate with, for automation or for accessing the user interfaces.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <strong>Route Tables</strong> in the Azure portal.</p>
</li>
<li>
<p>In the list of route tables, select the route table for the Ansible Automation Platform on Microsoft Azure managed application.</p>
<div class="paragraph">
<p>The name of the Ansible Automation Platform route table uses the following convention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>aks-agentpool-&lt;numbers&gt;-routetable</pre>
</div>
</div>
</li>
<li>
<p>From the route table menu bar, click <strong>Routes</strong> &gt; <strong>Add</strong>.</p>
</li>
<li>
<p>Configure routing to your VNets for each spoke network that you would like Ansible Automation Platform to communicate with, for both automation or accessing the user interfaces.</p>
</li>
<li>
<p>For each route that you add, enter the following information:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Route name</strong>: Enter a route name for the spoke network that you want Ansible Automation Platform to route to</p>
</li>
<li>
<p><strong>Address Prefix</strong>: The CIDR block of the spoke network</p>
</li>
<li>
<p><strong>Next Hop Type</strong>: <em>Virtual network gateway</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>OK</strong> to save the new route to the route list.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After you have configured the routing rules, traffic is routed to and from Ansible Automation Platform on Azure through your hub network.</p>
</div>
<div id="outbound-routing-virtual-appliances" class="paragraph">
<div class="title">Outbound routing through virtual appliances</div>
<p>If your organization uses Azure firewall services or third-party firewall appliances through a Virtual Appliance connection, you must configure outbound connectivity from the managed application, to enable Red Hat to maintain your application and to enable automation against external resources.</p>
</div>
<div class="paragraph">
<p>The easiest way to implement this is to create a firewall rule that allows all outbound traffic from port 443.</p>
</div>
<div class="paragraph">
<p>If you choose not to allow all outbound traffic from  port 443, you must configure routes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Red Hat to manage and upgrade Ansible Automation Platform on Microsoft Azure and execute security patching, any machine in the Azure Kubernetes service (AKS) cluster must be allowed to submit a request to pull updates for containers used by Ansible Automation Platform.
Add routes in the Ansible Automation Platform route table for outbound traffic from the full CIDR range of the Ansible Automation Platform on Microsoft Azure managed application to the following domains:</p>
<div class="ulist">
<ul>
<li>
<p><code>registry.redhat.io</code></p>
</li>
<li>
<p><code>quay.io</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>You must also allow traffic from your firewall to any other external domain or IP address that you want Ansible Automation Platform to run automation jobs against.
Otherwise, your firewall will block connectivity between Ansible Automation Platform and destinations for automation.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_additional_resources">Additional resources</h6>
<div class="paragraph">
<p>For further information about adding routes to a route table in Azure, refer to <a href="https://docs.microsoft.com/en-us/azure/virtual-network/manage-route-table#create-a-route">Create a route</a> in the Microsoft Azure <em>Virtual network</em> guide.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="aap-azure-vwan-peering">3.2. Azure Virtual WAN (VWAN)</h3>
<div class="sect3">
<h4 id="proc-peer-vwan-hub-to-aap_aap-azure-vwan-peering">3.2.1. Peering a VWAN Hub to the Ansible Automation Platform on Microsoft Azure Network</h4>
<div class="paragraph">
<p>Before peering, you must connect a hub network, and at least one spoke network, to the hub network of the Azure VWAN to which you intend to connect Ansible Automation Platform on Microsoft Azure.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A pre-configured Azure VWAN.</p>
</li>
<li>
<p>One or more of the following connections to the VWAN:</p>
<div class="ulist">
<ul>
<li>
<p>A DMZ network that contains Azure virtual machines that users can remotely log into to access Ansible Automation Platform on Microsoft Azure.</p>
</li>
<li>
<p>A DMZ network that contains an Azure virtual machine that local machines can connect to with SSH tunneling to access Ansible Automation Platform on Microsoft Azure.</p>
</li>
<li>
<p>A VPN or Direct Connect service to your local network that routes traffic from local machines to Ansible Automation Platform on Microsoft Azure.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to the <strong>Virtual Network Connections</strong> page for the VWAN that you want to peer with your Ansible Automation Platform instance.</p>
</li>
<li>
<p>To create a connection between the VWAN hub and your Ansible Automation Platform instance, use the following settings:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Connection Name</strong>: <em>&lt;Ansible_Automation_Platform_connection_name&gt;</em></p>
</li>
<li>
<p><strong>Hubs</strong>: Select one or more VWAN hub networks that the managed application VNet will peer with.</p>
</li>
<li>
<p><strong>Subscription</strong>: Select the subscription where Ansible Automation Platform on Microsoft Azure has been deployed.</p>
</li>
<li>
<p><strong>Resource group</strong>: The managed resource group of the managed application. It is typically prefixed with “mrg-”.</p>
</li>
<li>
<p><strong>Virtual network</strong>: The VNet of the managed application. There is only one VNet in the managed resource group.</p>
</li>
<li>
<p><strong>Propagate to none</strong>: <em>No</em></p>
</li>
<li>
<p><strong>Associate Route Table</strong>: Select the default route table or the appropriate route table that your organization has configured for VWAN.</p>
</li>
<li>
<p><strong>Propagate to Route Tables</strong>: Select one or more default route tables or the appropriate route table that your organization has configured for VWAN.</p>
</li>
<li>
<p><strong>Propagate to labels</strong>: Select labels if your organization uses them.</p>
</li>
<li>
<p><strong>Static routes</strong>: Do not complete this field.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When network peering completes, traffic routes to and from Ansible Automation Platform on Microsoft Azure though your VWAN hub network.</p>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/azure/virtual-wan/howto-connect-vnet-hub">Connect a virtual network to a Virtual WAN hub - portal</a> (Microsoft Azure Virtual WAN documentation)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="aap-azure-direct-peering">3.3. Direct peering</h3>
<div class="paragraph _abstract">
<p>You can use direct peering to directly connect virtual networks.
When two networks are peered, Azure updates routes between them so that traffic automatically flows between them.</p>
</div>
<div class="paragraph">
<p>The direct peering method is easier to configure than the hub-and-spoke model.
However, the number of direct network peerings is limited.
Direct peering becomes difficult to manage as the number of virtual networks grows, because each new network requires peering to all other networks.</p>
</div>
<div class="sect3">
<h4 id="proc-azure-nw-direct-peering_aap-azure-direct-peering">3.3.1. Configuring direct network peering</h4>
<div class="paragraph">
<p>You can configure network peering between your Azure network and your VNet in the <strong>Virtual Networks</strong> page of the Azure Portal.</p>
</div>
<div class="paragraph">
<p>Within the Azure console, the Azure virtual network is known as <em>this virtual network</em>, and the VNet that you want to peer with is known as <em>remote virtual network</em>.</p>
</div>
<div class="paragraph">
<p>In the <strong>Virtual Networks</strong> page in the Azure portal, use the following settings to configure the Azure network and the VNet that you want to peer with the Ansible Automation Platform on Microsoft Azure app:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Under <strong>This virtual network</strong>, select settings for the Ansible Automation Platform on Microsoft Azure virtual network:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Peering link name</strong>: <em>&lt;hub_to_aap_peering_link_name&gt;</em></p>
</li>
<li>
<p><strong>Traffic</strong> to remote virtual network: <em>Allow</em></p>
</li>
<li>
<p><strong>Traffic</strong> forwarded from remote virtual network: <em>Allow</em></p>
</li>
<li>
<p><strong>Virtual network gateway or Route Server</strong>: <em>Use this network’s gateway or Route server</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Under <strong>Remote virtual network</strong>, select settings for the virtual network that you want to peer with Azure:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Peering link name</strong>: <em>&lt;aap_to_hub_peering_link_name&gt;</em></p>
</li>
<li>
<p><strong>Subscription</strong>: Select the subscription where Ansible Automation Platform on Microsoft Azure has been deployed</p>
</li>
<li>
<p><strong>Virtual network</strong>: Select the Ansible Automation Platform on Microsoft Azure virtual network: vnet-&lt;aap_identifier&gt;-&lt;region&gt;</p>
</li>
<li>
<p><strong>Traffic to remote virtual network</strong>: <em>Allow</em></p>
</li>
<li>
<p><strong>Traffic forwarded from remote virtual network</strong>: <em>Allow</em></p>
</li>
<li>
<p><strong>Virtual network gateway or Route Server</strong>: <em>Use the remote virtual network’s gateway or Route server</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>After you have configured direct network peering, traffic routes between Ansible Automation Platform on Microsoft Azure and private hosts and IPs on your Vnet.</p>
</div>
<div class="paragraph">
<p>For more detailed instructions for configuring peering, refer to <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-manage-peering#create-a-peering">Create a peering</a> in the Microsoft Azure <em>Virtual network</em> guide.</p>
</div>
<div class="paragraph">
<p>For further information on direct peering, refer to <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview">Virtual network peering</a> in the Microsoft Azure <em>Virtual network</em> guide.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aap-azure-connecting-to-aap">4. Connecting to Red Hat Ansible Automation Platform</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>When network peering is complete and your Azure routing configuration is established, you can choose how your team accesses Ansible Automation Platform through your Azure network configuration.</p>
</div>
<div class="sect2">
<h3 id="proc-azure-nw-access-details_aap-azure-connecting-to-aap">4.1. Access details</h3>
<div class="paragraph">
<p>Regardless of whether Ansible Automation Platform was deployed with public or private access,
a set of DNS records is created.
The DNS records are created so that Ansible Automation Platform can be issued a valid TLS certificate for your deployment and to enable easy access to your applications.</p>
</div>
<div class="paragraph">
<p>To view a list of the URLs for the Ansible Automation Platform applications, navigate to the <strong>Parameters and Outputs</strong> page of the Azure Marketplace managed application listing for your deployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="proc-azure-nw-public-deploy_aap-azure-connecting-to-aap">4.2. Public Deployments</h3>
<div class="paragraph">
<p>If you selected public access when you deployed Ansible Automation Platform on Microsoft Azure, you can access the Ansible Automation Platform application URLs over the public internet from a browser.</p>
</div>
</div>
<div class="sect2">
<h3 id="proc-azure-nw-private-deploy_aap-azure-connecting-to-aap">4.3. Private deployments</h3>
<div class="paragraph">
<p>If you selected private access when deploying Ansible Automation Platform on Microsoft Azure,
then the DNS record issued to the Red Hat Ansible Automation Platform on Microsoft Azure application points to a private address within the CIDR block selected when the managed application was deployed.
You must configure access to this address after you have created network peering.</p>
</div>
<div class="paragraph">
<p>The configuration and access method that you choose to connect to Ansible Automation Platform on Microsoft Azure depends on how your organization manages Azure infrastructure.
Your Azure administrators must determine the right model for your organization and configure the setup for you.</p>
</div>
<div class="paragraph">
<p>The following are the most common options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#proc-azure-nw-private-deploy-az-hosted-vm_aap-azure-connecting-to-aap">Azure hosted virtual machine</a></p>
</li>
<li>
<p><a href="#proc-azure-nw-private-deploy-vpn_aap-azure-connecting-to-aap">VPN</a></p>
</li>
<li>
<p><a href="#proc-azure-nw-private-deploy-ssh-tunnel_aap-azure-connecting-to-aap">SSH tunnel</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="proc-azure-nw-private-deploy-az-hosted-vm_aap-azure-connecting-to-aap">4.3.1. Azure hosted virtual machine</h4>
<div class="paragraph">
<p>A straightforward way to configure access for a small set of users to access private network resources on Azure networks is to create a jumpbox VM in a perimeter network (DMZ VNet) that users can remotely log into from the public internet.
The jumpbox VM requires workstation features such as a GUI and browser.</p>
</div>
<div class="paragraph">
<p>Users can remotely log into the publicly accessible virtual machine from on-premises machines through VNC, RDP, or other screen-sharing protocols.</p>
</div>
<div class="paragraph">
<p>To access the Ansible Automation Platform web UIs on the Azure private network, users navigate to the URLs using the browser on the jumpbox VM.</p>
</div>
<div class="paragraph">
<p>The DMZ VNet is connected to other Azure VNets through network peering, with routing rules established to send network traffic to the Ansible Automation Platform VNet.</p>
</div>
<div class="paragraph">
<p>The following diagram shows the topology for an example configuration of private network access via an Azure virtual machine.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aap-on-azure-private-nw-access-vm.png" alt="aap on azure private nw access vm">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For more information about perimeter (DMZ) networks, refer to <a href="https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/perimeter-networks">Perimeter Networks</a> in the Microsoft <em>Azure Cloud Adoption Framework</em> documentation.</p>
</li>
<li>
<p>For more information about jumpboxes, refer to
<a href="https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/cloud-scale-analytics/architectures/connect-to-environments-privately#about-azure-bastion-host-and-jumpboxes">About Azure bastion host and jumpboxes</a>
in the Microsoft <em>Azure Cloud Adoption Framework</em> documentation.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="proc-azure-nw-private-deploy-vpn_aap-azure-connecting-to-aap">4.3.2. VPN</h4>
<div class="paragraph">
<p>If your organization requires that many users access Ansible Automation Platform over a private connection, or if your organization already uses VPNs or direct connections with Azure, then this approach might be suitable.</p>
</div>
<div class="paragraph">
<p>In this configuration, your on-premises infrastructure is connected to Azure through a Network Application Gateway and has routing rules that can enable access to Ansible Automation Platform to any connected computer on the local network.
The VNet connected to the Virtual Network Gateway is connected to other Azure VNets through network peering, with routing rules established to send network traffic to the Ansible Automation Platform VNet.</p>
</div>
<div class="paragraph">
<p>With this configuration, users can access Ansible Automation Platform through the application URLs as if they were using the public access approach.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aap-on-azure-private-nw-access-vpn.png" alt="aap on azure private nw access vpn">
</div>
</div>
</div>
<div class="sect3">
<h4 id="proc-azure-nw-private-deploy-ssh-tunnel_aap-azure-connecting-to-aap">4.3.3. SSH tunnel</h4>
<div class="paragraph">
<p>When VPN is not an option and your local users are more technical, the SSH tunnel approach is a secure alternative that enables users to access Ansible Automation Platform from a browser on a local machine.</p>
</div>
<div class="paragraph">
<p>To implement this access model, create a lightweight Linux-based SSH server in a DMZ network, similar to the Azure Hosted Virtual Machine method.
The SSH server does not require any workstation features, because it simply acts as a proxy between a user’s local machine and Ansible Automation Platform on Microsoft Azure.</p>
</div>
<div class="paragraph">
<p>Each user must be configured as an SSH user on the server.
Users can then establish an SSH tunnel from the local machine to the SSH server to route traffic for Ansible Automation Platform on Microsoft Azure.</p>
</div>
<div class="paragraph">
<p>This approach is easier to implement on Linux and macOS host machines, but can be accomplished on Windows.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Update your local hosts file so that the Ansible Automation Platform URLs route traffic to your local machine rather than the private IP that DNS records are configured with.
Add the following line to your hosts file:</p>
<div class="listingblock">
<div class="content">
<pre>127.0.0.1 controller.&lt;<em>your_AAPonAzure_instance</em>&gt;.az.ansiblecloud.com</pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows the line in a hosts file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>##
# Host Database
#
# localhost is used to configure the loopback interface
# when the system is booting. Do not change this entry.
#
127.0.0.1       localhost
255.255.255.255 broadcasthost
::1             localhost

127.0.0.1 controller.&lt;<em>your_AAPonAzure_instance</em>&gt;.az.ansiblecloud.com</pre>
</div>
</div>
</li>
<li>
<p>As a user with root privileges, run the <code>ssh</code> command to establish an SSH tunnel.</p>
<div class="paragraph">
<p>In the example below, <code><em>SSH_server_IP</em></code> represents the IP address of the SSH server in your DMZ.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sudo ssh azureuser@&lt;<em>SSH_server_IP</em>&gt; -i ~/.ssh/id_ssh_key -N -f -L 443:controller.&lt;<em>your_AAPonAzure_instance</em>&gt;.az.ansiblecloud.com:443</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-L</code> flag makes your local system route traffic for the automation controller URL over port 443 (HTTPs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You must use port 443 on both sides of the routing path. Using a different port on the local machine causes some Ansible Automation Platform features to not function properly.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When the SSH tunnel is established and your Azure routing is configured, you can access the automation controller URL from your local browser at https://controller.&lt;<em>your_AAPonAzure_instance</em>&gt;.az.ansiblecloud.com.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/aap-on-azure-private-nw-access-ssh.png" alt="aap on azure private nw access ssh">
</div>
</div>
<div class="paragraph">
<p> </p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-11-14 17:36:08 UTC
</div>
</div>
</body>
</html>